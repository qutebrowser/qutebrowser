{
    "app-id": "org.qutebrowser.qutebrowser",
    "branch": "stable",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "1.6",
    "sdk": "org.freedesktop.Sdk",
    "command": "qutebrowser",
    "finish-args": [
        /* Nested sandboxes are currently not support by flatpak */
        "--env=QTWEBENGINE_DISABLE_SANDBOX=1",
        /* Allow direct rendering to use OpenGL and access to webcams */
        "--device=all",
        /* Allow to read all files from the home directory */
        "--filesystem=home:ro",
        /* Allow to save downloads */
        "--filesystem=xdg-download",
        /* Allow IPC access for performance reasons (X shared memory extension) */
        "--share=ipc",
        /* Allow network access */
        "--share=network",
        /* Allow to play sounds using pulseaudio */
        "--socket=pulseaudio",
        /* Allow to provide a graphical UI */
        "--socket=wayland",
        "--socket=x11"
    ],
    "rename-desktop-file": "qutebrowser.desktop",
    "rename-appdata-file": "qutebrowser.appdata.xml",
    "rename-icon": "qutebrowser",
    "cleanup": [
        "/include",
        "/bin/sip",
        "/lib/debug"
    ],
    "modules": [
        "udev-175.json",
        {
            "name": "PyQt5",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --prefix=/app PyQt5-5.10-5.10.0-cp35.cp36.cp37-abi3-manylinux1_x86_64.whl"
            ],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "file",
                    "url": "https://pypi.python.org/packages/ae/4b/c7315ba7a266d493ee50c4597b1b4dea2348896a49115b5192b21adf1a47/PyQt5-5.10-5.10.0-cp35.cp36.cp37-abi3-manylinux1_x86_64.whl",
                    "sha256": "dbd1777d8e7540a6e7350482f1d7c981a073ce1b7195ac2cd21c204b3a28df57"
                }
            ],
            "modules": [
                {
                    "name": "sip",
                    "buildsystem": "simple",
                    "build-commands": [
                        "pip3 install --prefix=/app sip-4.19.7-cp35-cp35m-manylinux1_x86_64.whl"
                    ],
                    "ensure-writable": ["easy-install.pth"],
                    "sources": [
                        {
                            "type": "file",
                            "url": "https://pypi.python.org/packages/65/aa/0ecb10b41090b2cd1a910d168aca4808f73b9c65d2ea7c25c852b942b2a0/sip-4.19.7-cp35-cp35m-manylinux1_x86_64.whl",
                            "sha256": "776e169da554729f80337070348db49a6742d8aa317aec931a4d0f47b7ef535d"
                        }
                    ]
                }
            ]
        },
        {
            "name": "MarkupSafe",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/4d/de/32d741db316d8fdb7680822dd37001ef7a448255de9699ab4bfcbdf4172b/MarkupSafe-1.0.tar.gz",
                    "sha256": "a6be69091dac236ea9c6bc7d012beab42010fa914c459791d627dad4910eb665"
                }
            ]
        },
        {
            "name": "attrs",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/8b/0b/a06cfcb69d0cb004fde8bc6f0fd192d96d565d1b8aa2829f0f20adb796e5/attrs-17.4.0.tar.gz",
                    "sha256": "1c7960ccfd6a005cd9f7ba884e6316b5e430a3f1a6c37c5f87d8b43f83b54ec9"
                }
            ]
        },
        {
            "name": "cssutils",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "cleanup": [ "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/5c/0b/c5f29d29c037e97043770b5e7c740b6252993e4b57f029b3cd03c78ddfec/cssutils-1.0.2.tar.gz",
                    "sha256": "a2fcf06467553038e98fea9cfe36af2bf14063eb147a70958cfcaa8f5786acaf"
                }
            ]
        },
        {
            "name": "Jinja2",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/56/e6/332789f295cf22308386cf5bbd1f4e00ed11484299c5d7383378cf48ba47/Jinja2-2.10.tar.gz",
                    "sha256": "f84be1bb0040caca4cea721fcbbbbd61f9be9464ca236387158b0feea01914a4"
                }
            ]
        },
        {
            "name": "Pygments",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "cleanup": [ "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/71/2a/2e4e77803a8bd6408a2903340ac498cb0a2181811af7c9ec92cb70b0308a/Pygments-2.2.0.tar.gz",
                    "sha256": "dbae1046def0efb574852fab9e90209b23f556367b5a320c0bcb871c77c3e8cc"
                }
            ]
        },
        {
            "name": "pyPEG2",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/f9/bd/10398e2c2d2070cc8a9c7153abfbd4ddb2895a2c52a32722ab8689e0cc7d/pyPEG2-2.15.2.tar.gz",
                    "sha256": "2b2d4f80d8e1a9370b2a91f4a25f4abf7f69b85c8da84cd23ec36451958a1f6d"
                }
            ]
        },
        {
            "name": "PyYAML",
            "buildsystem": "simple",
            "build-commands": ["python3 setup.py install --prefix=/app"],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://pyyaml.org/download/pyyaml/PyYAML-3.12.tar.gz",
                    "sha256": "592766c6303207a20efc445587778322d7f73b161bd994f227adaa341ba212ab"
                }
            ]
        },
        {
            "name": "flatpak-xdg-open-shim",
            "sources": [
                {
                    "type": "git",
                    "url": "git://github.com/mattdangerw/flatpak-xdg-open-shim",
                    "commit": "7de8f1273c414f7d797d8487511861a7330b61fe"
                }
            ]
        },
        {
            "name": "qutebrowser",
            "buildsystem": "simple",
            "build-commands": [
                "python3 setup.py install --prefix=/app"
            ],
            "post-install": [
                /* We currently only need the desktop, appstream and icon files */
                "install -Dm644 misc/qutebrowser.appdata.xml /app/share/appdata/qutebrowser.appdata.xml",
                "install -Dm644 misc/qutebrowser.desktop /app/share/applications/qutebrowser.desktop",
                "install -Dm644 icons/qutebrowser.svg /app/share/icons/hicolor/scalable/apps/qutebrowser.svg",
                "for SIZE in 16 24 32 48 64 128 256 512; do install -Dm644 icons/qutebrowser-${SIZE}x${SIZE}.png /app/share/icons/hicolor/${SIZE}x${SIZE}/apps/qutebrowser.png; done"
            ],
            "ensure-writable": ["easy-install.pth"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/qutebrowser/qutebrowser/archive/v1.1.1.tar.gz",
                    "sha256": "9ac5b5c7382748481dd7fac35ffd0cfe509413880ffdc8a35eac9dafa5399166"
                }
             ]
         }
    ]
}
